<!DOCTYPE html>
<html lang="es">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>eMercado - Todo lo que busques está aquí</title>
  <link href="https://fonts.googleapis.com/css?family=Raleway:300,300i,400,400i,700,700i,900,900i" rel="stylesheet">
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/font-awesome.min.css" rel="stylesheet">
  <!-- Bootstrap Icons para el ícono del carrito -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <link href="css/styles.css" rel="stylesheet">
  <link href="css/theme.css" rel="stylesheet">
  <link href="css/cart.css" rel="stylesheet">
  <script src="js/theme.js"></script>
</head>

<body>
  <!-- Header - Navegación -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark p-1">
    <div class="container">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav w-100 justify-content-between">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Inicio</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="categories.html">Categorías</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="sell.html">Vender</a>
          </li>
          <!-- ¡DESAFIATE! - Autor: Máximo Gallo -->
          <!-- Badge que muestra la cantidad total de productos en el carrito -->
          <li class="nav-item">
            <a class="nav-link position-relative" href="cart.html">
              <i class="bi bi-cart3"></i>
              <span id="cart-badge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none;">
                0
              </span>
            </a>
          </li>
          <!-- Nombre del usuario logueado -->
          <li class="nav-item">
            <span class="nav-link text-light" id="userName"></span>
          </li>
          <!-- Toggle de tema claro/oscuro -->
          <li class="nav-item">
            <div class="theme-toggle-wrapper nav-link">
              <label class="theme-switch">
                <input type="checkbox" id="theme-toggle">
                <span class="theme-slider"></span>
              </label>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Contenido principal -->
  <main>
    <div class="container">
      <div class="cart-container">
        
        <!-- Columna izquierda: Lista de productos en el carrito -->
        <!-- ENTREGA 3 - Autor: Máximo Gallo -->
        <!-- Replicamos el diseño del prototipo y cargamos productos desde localStorage -->
        <div class="cart-items">
          <h1 class="cart-title">Carrito de compras</h1>
          
          <!-- ENTREGA 3 - Autor: Máximo Gallo -->
          <!-- Mensaje que se muestra cuando el carrito está vacío -->
          <div id="empty-cart-message" class="empty-cart" style="display: none;">
            <p>No hay productos en tu carrito</p>
            <a href="categories.html" class="btn btn-dark">Ir a comprar</a>
          </div>

          <!-- ENTREGA 3 - Autor: Máximo Gallo -->
          <!-- Contenedor donde se cargarán dinámicamente los productos del carrito -->
          <div id="cart-items-container">
            <!-- Los productos se cargarán aquí desde JavaScript -->
          </div>

        </div>

        <!-- Columna derecha: Resumen de compra y formularios -->
        <!-- ENTREGA 5 - Autor: Máximo Gallo -->
        <!-- Formulario completo de checkout con todas las secciones -->
        <div class="cart-summary">
          
          <!-- SECCIÓN 1: TIPO DE ENVÍO -->
          <div class="summary-card mb-3">
            <h2 class="summary-title">Tipo de envío</h2>
            <div class="shipping-options">
              <div class="shipping-option">
                <input type="radio" id="shipping-premium" name="shipping-type" value="0.15" class="shipping-radio">
                <label for="shipping-premium" class="shipping-label">
                  <div class="shipping-info">
                    <span class="shipping-name">Premium</span>
                    <span class="shipping-time">2 a 5 días</span>
                  </div>
                  <span class="shipping-cost">15%</span>
                </label>
              </div>
              <div class="shipping-option">
                <input type="radio" id="shipping-express" name="shipping-type" value="0.07" class="shipping-radio">
                <label for="shipping-express" class="shipping-label">
                  <div class="shipping-info">
                    <span class="shipping-name">Express</span>
                    <span class="shipping-time">5 a 8 días</span>
                  </div>
                  <span class="shipping-cost">7%</span>
                </label>
              </div>
              <div class="shipping-option">
                <input type="radio" id="shipping-standard" name="shipping-type" value="0.05" class="shipping-radio" checked>
                <label for="shipping-standard" class="shipping-label">
                  <div class="shipping-info">
                    <span class="shipping-name">Standard</span>
                    <span class="shipping-time">12 a 15 días</span>
                  </div>
                  <span class="shipping-cost">5%</span>
                </label>
              </div>
            </div>
            <div class="form-error" id="shipping-error" style="display: none;">
              <i class="fa fa-exclamation-circle"></i> Debe seleccionar un tipo de envío
            </div>
          </div>

          <!-- SECCIÓN 2: DIRECCIÓN DE ENVÍO -->
          <div class="summary-card mb-3">
            <h2 class="summary-title">Dirección de envío</h2>
            <form id="shipping-address-form">
              <div class="form-group">
                <label for="department">Departamento <span class="required">*</span></label>
                <input type="text" id="department" class="form-input" placeholder="Ej: Montevideo" required>
                <div class="form-error" id="department-error" style="display: none;"></div>
              </div>
              <div class="form-group">
                <label for="locality">Localidad <span class="required">*</span></label>
                <input type="text" id="locality" class="form-input" placeholder="Ej: Pocitos" required>
                <div class="form-error" id="locality-error" style="display: none;"></div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="street">Calle <span class="required">*</span></label>
                  <input type="text" id="street" class="form-input" placeholder="Ej: 18 de Julio" required>
                  <div class="form-error" id="street-error" style="display: none;"></div>
                </div>
                <div class="form-group form-group-small">
                  <label for="number">Número <span class="required">*</span></label>
                  <input type="text" id="number" class="form-input" placeholder="1234" required>
                  <div class="form-error" id="number-error" style="display: none;"></div>
                </div>
              </div>
              <div class="form-group">
                <label for="corner">Esquina <span class="required">*</span></label>
                <input type="text" id="corner" class="form-input" placeholder="Ej: Andes" required>
                <div class="form-error" id="corner-error" style="display: none;"></div>
              </div>
            </form>
          </div>

          <!-- SECCIÓN 3: FORMA DE PAGO -->
          <div class="summary-card mb-3">
            <h2 class="summary-title">Forma de pago</h2>
            <div class="payment-options">
              <button type="button" class="payment-btn" id="payment-card-btn">
                <i class="fa fa-credit-card"></i>
                <span>Tarjeta de crédito</span>
                <i class="fa fa-check payment-check" style="display: none;"></i>
              </button>
              <button type="button" class="payment-btn" id="payment-transfer-btn">
                <i class="fa fa-university"></i>
                <span>Transferencia bancaria</span>
                <i class="fa fa-check payment-check" style="display: none;"></i>
              </button>
            </div>
            <div class="form-error" id="payment-error" style="display: none;">
              <i class="fa fa-exclamation-circle"></i> Debe seleccionar una forma de pago
            </div>
          </div>

          <!-- SECCIÓN 4: COSTOS -->
          <div class="summary-card mb-3">
            <h2 class="summary-title">Resumen de compra</h2>
            
            <!-- ENTREGA 5 - Subtotal calculado -->
            <div class="summary-line">
              <span>Subtotal</span>
              <span id="subtotal-amount" class="amount">$0.00</span>
            </div>
            
            <!-- ENTREGA 5 - Costo de envío (subtotal × porcentaje) -->
            <div class="summary-line">
              <span>Costo de envío <span id="shipping-percentage">(5%)</span></span>
              <span id="shipping-amount" class="amount">$0.00</span>
            </div>
            
            <!-- ENTREGA 5 - Total final -->
            <div class="summary-total">
              <span>Total</span>
              <span id="total-amount" class="amount">$0.00</span>
            </div>
          </div>

          <!-- SECCIÓN 5: BOTONES DE ACCIÓN -->
          <div class="summary-card">
            <!-- Botón Finalizar Compra -->
            <button class="checkout-btn" id="finalize-purchase-btn">
              <i class="fa fa-shopping-cart"></i> Finalizar Compra
            </button>
            
            <!-- Botón Continuar Comprando -->
            <button class="continue-shopping" onclick="window.location.href='categories.html'">
              <i class="fa fa-arrow-left"></i> Continuar comprando
            </button>
          </div>

        </div>

      </div>
    </div>
  </main>

  <!-- ============================================ -->
  <!-- MODAL DE CONFIRMACIÓN - Autor: Máximo Gallo -->
  <!-- Modal reutilizable para diferentes acciones -->
  <!-- ============================================ -->
  <div id="confirmation-modal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <div id="modal-icon" class="modal-icon warning">
          <i class="fa fa-exclamation-triangle"></i>
        </div>
        <h3 id="modal-title" class="modal-title">Confirmar acción</h3>
      </div>
      <p id="modal-message" class="modal-message">
        ¿Estás seguro de realizar esta acción?
      </p>
      <div class="modal-actions">
        <button id="modal-cancel" class="modal-btn modal-btn-cancel">Cancelar</button>
        <button id="modal-confirm" class="modal-btn modal-btn-confirm">Confirmar</button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- ENTREGA 5 - MODAL TARJETA DE CRÉDITO -->
  <!-- ============================================ -->
  <div id="payment-card-modal" class="payment-modal-overlay">
    <div class="payment-modal">
      <div class="payment-modal-header">
        <h3 class="payment-modal-title">Tarjeta de crédito</h3>
        <button class="payment-modal-close" id="close-card-modal" aria-label="Cerrar">&times;</button>
      </div>
      <div class="payment-modal-body">
        <form id="card-payment-form">
          <div class="form-group">
            <label for="card-number">Número de tarjeta <span class="required">*</span></label>
            <input type="text" id="card-number" class="form-input" placeholder="1234 5678 9012 3456" maxlength="19" required>
            <div class="form-error" id="card-number-error" style="display: none;"></div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="card-expiry">Vencimiento <span class="required">*</span></label>
              <input type="text" id="card-expiry" class="form-input" placeholder="MM/AA" maxlength="5" required>
              <div class="form-error" id="card-expiry-error" style="display: none;"></div>
            </div>
            <div class="form-group">
              <label for="card-cvv">CVV <span class="required">*</span></label>
              <input type="text" id="card-cvv" class="form-input" placeholder="123" maxlength="4" required>
              <div class="form-error" id="card-cvv-error" style="display: none;"></div>
            </div>
          </div>
          <div class="form-group">
            <label for="card-name">Nombre del titular <span class="required">*</span></label>
            <input type="text" id="card-name" class="form-input" placeholder="JUAN PEREZ" required>
            <div class="form-error" id="card-name-error" style="display: none;"></div>
          </div>
        </form>
      </div>
      <div class="payment-modal-footer">
        <button class="modal-btn modal-btn-cancel" id="cancel-card-modal">Cancelar</button>
        <button class="modal-btn modal-btn-save" id="save-card-payment">Guardar</button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- ENTREGA 5 - MODAL TRANSFERENCIA BANCARIA -->
  <!-- ============================================ -->
  <div id="payment-transfer-modal" class="payment-modal-overlay">
    <div class="payment-modal">
      <div class="payment-modal-header">
        <h3 class="payment-modal-title">Transferencia bancaria</h3>
        <button class="payment-modal-close" id="close-transfer-modal" aria-label="Cerrar">&times;</button>
      </div>
      <div class="payment-modal-body">
        <form id="transfer-payment-form">
          <div class="form-group">
            <label for="bank-name">Banco <span class="required">*</span></label>
            <select id="bank-name" class="form-input" required>
              <option value="">Seleccione un banco</option>
              <option value="BROU">Banco República</option>
              <option value="Santander">Santander</option>
              <option value="BBVA">BBVA</option>
              <option value="Itau">Itaú</option>
              <option value="Scotiabank">Scotiabank</option>
              <option value="Heritage">Heritage</option>
            </select>
            <div class="form-error" id="bank-name-error" style="display: none;"></div>
          </div>
          <div class="form-group">
            <label for="account-number">Número de cuenta <span class="required">*</span></label>
            <input type="text" id="account-number" class="form-input" placeholder="Ej: 123456789" required>
            <div class="form-error" id="account-number-error" style="display: none;"></div>
          </div>
          <div class="form-group">
            <label for="account-holder">Titular de la cuenta <span class="required">*</span></label>
            <input type="text" id="account-holder" class="form-input" placeholder="Ej: Juan Pérez" required>
            <div class="form-error" id="account-holder-error" style="display: none;"></div>
          </div>
        </form>
      </div>
      <div class="payment-modal-footer">
        <button class="modal-btn modal-btn-cancel" id="cancel-transfer-modal">Cancelar</button>
        <button class="modal-btn modal-btn-save" id="save-transfer-payment">Guardar</button>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- ENTREGA 5 - MODAL COMPRA EXITOSA -->
  <!-- ============================================ -->
  <div id="success-modal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <div class="modal-icon success">
          <i class="fa fa-check"></i>
        </div>
        <h3 class="modal-title">¡Compra exitosa!</h3>
      </div>
      <p class="modal-message">
        Tu pedido ha sido procesado correctamente. Recibirás un correo con los detalles de tu compra.
      </p>
      <div id="purchase-summary" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 14px;"></div>
      <div class="modal-actions">
        <button id="close-success-modal" class="modal-btn modal-btn-primary">Aceptar</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="text-muted">
    <div class="container">
      <p class="float-end">
        <a href="#">Volver arriba</a>
      </p>
      <p>Este sitio forma parte de <a href="https://jovenesaprogramar.edu.uy/" target="_blank">Jovenes a Programar</a></p>
    </div>
  </footer>

  <!-- Spinner de carga -->
  <div id="spinner-wrapper">
    <div class="lds-ring">
      <div></div>
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/init.js"></script>
  <script src="js/cart.js"></script>
</body>

</html>